{"ast":null,"code":"import _toConsumableArray from\"C:/Users/svyat/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/svyat/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import'../index.css';import Header from'./Header';import Main from'./Main';import Footer from'./Footer';import PopupWithForm from'./PopupWithForm';import EditProfilePopup from'./EditProfilePopup';import EditAvatarPopup from'./EditAvatarPopup';import AddPlacePopup from'./AddPlacePopup';import ImagePopup from'./ImagePopup';import api from'../utils/api';import{CurrentUserContext}from'../contexts/CurrentUserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditProfilePopupOpen=_React$useState2[0],setEditProfilePopupOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isAddPlacePopupOpen=_React$useState4[0],setAddPlacePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isEditAvatarPopupOpen=_React$useState6[0],setEditAvatarPopupOpen=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),selectedCard=_React$useState8[0],setSelectedCard=_React$useState8[1];var _React$useState9=React.useState([]),_React$useState10=_slicedToArray(_React$useState9,2),cards=_React$useState10[0],setCards=_React$useState10[1];var _React$useState11=React.useState({}),_React$useState12=_slicedToArray(_React$useState11,2),currentUser=_React$useState12[0],setCurrentUser=_React$useState12[1];React.useEffect(function(){api.getUserInfo().then(function(userInfo){setCurrentUser(userInfo);}).catch(function(err){console.log(err);});},[]);React.useEffect(function(){api.getCards().then(function(res){setCards(res);}).catch(function(err){console.log(err);});},[]);function handleEditAvatarClick(){setEditAvatarPopupOpen(true);}function handleEditProfileClick(){setEditProfilePopupOpen(true);}function handleAddPlaceClick(){setAddPlacePopupOpen(true);}function closeAllPopups(){setEditProfilePopupOpen(false);setAddPlacePopupOpen(false);setEditAvatarPopupOpen(false);setSelectedCard(null);}function handleCardClick(card){setSelectedCard(card);}function handleUpdateUser(card){api.editUserInfo(card).then(function(res){setCurrentUser(res);setEditProfilePopupOpen(false);}).catch(function(err){console.log(err);});}function handleUpdateAvatar(card){api.editAvatar(card).then(function(res){setCurrentUser(res);setEditAvatarPopupOpen(false);}).catch(function(err){console.log(err);});}function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});api.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(newArr){return newArr!==card;});});}).catch(function(err){console.log(err);});}function handleAddPlaceSubmit(card){api.createCard(card).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));setAddPlacePopupOpen(false);}).catch(function(err){console.log(err);});}return/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditAvatar:handleEditAvatarClick,onAddPlace:handleAddPlaceClick,onEditProfile:handleEditProfileClick,onCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete,setCards:setCards}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"delete-card\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",button:\"\\u0414\\u0430\"}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups})]});}export default App;","map":{"version":3,"sources":["C:/Users/svyat/dev/react-mesto-api-full/frontend/src/components/App.js"],"names":["React","Header","Main","Footer","PopupWithForm","EditProfilePopup","EditAvatarPopup","AddPlacePopup","ImagePopup","api","CurrentUserContext","App","useState","isEditProfilePopupOpen","setEditProfilePopupOpen","isAddPlacePopupOpen","setAddPlacePopupOpen","isEditAvatarPopupOpen","setEditAvatarPopupOpen","selectedCard","setSelectedCard","cards","setCards","currentUser","setCurrentUser","useEffect","getUserInfo","then","userInfo","catch","err","console","log","getCards","res","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","closeAllPopups","handleCardClick","card","handleUpdateUser","editUserInfo","handleUpdateAvatar","editAvatar","handleCardLike","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","state","map","c","handleCardDelete","deleteCard","filter","newArr","handleAddPlaceSubmit","createCard"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport '../index.css';\r\nimport Header from './Header';\r\nimport Main from './Main';\r\nimport Footer from './Footer';\r\nimport PopupWithForm from './PopupWithForm';\r\nimport EditProfilePopup from './EditProfilePopup';\r\nimport EditAvatarPopup from './EditAvatarPopup';\r\nimport AddPlacePopup from './AddPlacePopup';\r\nimport ImagePopup from './ImagePopup';\r\nimport api from '../utils/api';\r\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\r\n\r\n\r\nfunction App() {\r\n  const [isEditProfilePopupOpen, setEditProfilePopupOpen] = React.useState(false);\r\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\r\n  const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = React.useState(false);\r\n\r\n  const [selectedCard, setSelectedCard] = React.useState(null);\r\n  const [cards, setCards] = React.useState([]);\r\n\r\n  const [currentUser, setCurrentUser] = React.useState({});\r\n\r\n\r\n  React.useEffect(() => {\r\n    api.getUserInfo()\r\n      .then(userInfo => {\r\n        setCurrentUser(userInfo);\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }, [])\r\n\r\n  React.useEffect(() => {\r\n    api.getCards()\r\n      .then(res => {\r\n        setCards(res);\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }, [])\r\n\r\n\r\n  function handleEditAvatarClick() {\r\n    setEditAvatarPopupOpen(true);\r\n  }\r\n\r\n  function handleEditProfileClick() {\r\n    setEditProfilePopupOpen(true);\r\n  }\r\n\r\n  function handleAddPlaceClick() {\r\n    setAddPlacePopupOpen(true);\r\n  }\r\n\r\n  function closeAllPopups() {\r\n    setEditProfilePopupOpen(false);\r\n    setAddPlacePopupOpen(false);\r\n    setEditAvatarPopupOpen(false);\r\n\r\n    setSelectedCard(null)\r\n  }\r\n\r\n  function handleCardClick(card) {\r\n    setSelectedCard(card)\r\n  }\r\n\r\n  function handleUpdateUser(card) {\r\n    api.editUserInfo(card)\r\n      .then(res => {\r\n        setCurrentUser(res);\r\n\r\n        setEditProfilePopupOpen(false);\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n\r\n  function handleUpdateAvatar(card) {\r\n    api.editAvatar(card)\r\n      .then(res => {\r\n        setCurrentUser(res);\r\n\r\n        setEditAvatarPopupOpen(false)\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n\r\n  function handleCardLike(card) {\r\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\r\n\r\n    api.changeLikeCardStatus(card._id, !isLiked)\r\n      .then((newCard) => {\r\n        setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n\r\n  function handleCardDelete(card) {\r\n    api.deleteCard(card._id)\r\n      .then(() => {\r\n        setCards((state) => {\r\n          return state.filter(newArr => {\r\n            return newArr !== card\r\n          })\r\n        })\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n\r\n  function handleAddPlaceSubmit(card) {\r\n    api.createCard(card)\r\n      .then(newCard => {\r\n        setCards([newCard, ...cards]);\r\n\r\n        setAddPlacePopupOpen(false);\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n\r\n  return (\r\n    <CurrentUserContext.Provider value={currentUser}>\r\n      <Header />\r\n      <Main\r\n        onEditAvatar={handleEditAvatarClick}\r\n        onAddPlace={handleAddPlaceClick}\r\n        onEditProfile={handleEditProfileClick}\r\n        onCardClick={handleCardClick}\r\n        cards={cards}\r\n        onCardLike={handleCardLike}\r\n        onCardDelete={handleCardDelete}\r\n        setCards={setCards} />\r\n      <Footer />\r\n      <EditProfilePopup\r\n        isOpen={isEditProfilePopupOpen}\r\n        onClose={closeAllPopups}\r\n        onUpdateUser={handleUpdateUser}>\r\n      </EditProfilePopup>\r\n      <AddPlacePopup\r\n        isOpen={isAddPlacePopupOpen}\r\n        onClose={closeAllPopups}\r\n        onAddPlace={handleAddPlaceSubmit}>\r\n      </AddPlacePopup>\r\n      <EditAvatarPopup\r\n        isOpen={isEditAvatarPopupOpen}\r\n        onClose={closeAllPopups}\r\n        onUpdateAvatar={handleUpdateAvatar}>\r\n      </EditAvatarPopup>\r\n      <PopupWithForm\r\n        name=\"delete-card\"\r\n        title=\"Вы уверены?\"\r\n        button=\"Да\">\r\n      </PopupWithForm>\r\n      <ImagePopup\r\n        card={selectedCard}\r\n        onClose={closeAllPopups}>\r\n      </ImagePopup>\r\n    </CurrentUserContext.Provider>\r\n  )\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}